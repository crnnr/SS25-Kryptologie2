<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curveball CTF Challenge</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="background-particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <div class="container">
        <h1 class="logo">CURVEBALL</h1>
        <p class="subtitle">CVE-2020-0601 â€¢ Windows CryptoAPI Spoofing Vulnerability</p>
        
        <div class="introduction-section">
            <h3>ğŸ“š Was ist Curveball (CVE-2020-0601)?</h3>
            <div class="intro-content">
                <div class="intro-overview">
                    <p>
                        <strong>Curveball</strong> ist eine der kritischsten SicherheitslÃ¼cken in der Windows-Geschichte. 
                        Diese Schwachstelle in der Windows CryptoAPI ermÃ¶glichte es Angreifern, die Validierung von 
                        ECC-Zertifikaten vollstÃ¤ndig zu umgehen und sich als vertrauenswÃ¼rdige EntitÃ¤ten auszugeben.
                    </p>
                </div>

                <div class="intro-details">
                    <div class="detail-box">
                        <h4>ğŸ” Das Problem</h4>
                        <p>Windows validierte <strong>nicht korrekt</strong>, ob der Generator-Punkt G in ECC-Zertifikaten dem Standard entspricht. Angreifer konnten eigene Generator-Punkte verwenden!</p>
                    </div>

                    <div class="detail-box">
                        <h4>ğŸ§® Die Mathematik</h4>
                        <p>
                            <strong>Normal:</strong> Q = d Ã— G (d unbekannt, schwer zu finden)<br>
                            <strong>Curveball:</strong> Q = d' Ã— G' (d' und G' wÃ¤hlbar!)
                        </p>
                    </div>

                    <div class="detail-box">
                        <h4>âš¡ Der Exploit</h4>
                        <p>Durch Manipulation des Generator-Punkts konnten Angreifer Zertifikate erstellen, die Windows als "von vertrauenswÃ¼rdigen CAs signiert" akzeptierte.</p>
                    </div>
                </div>

                <div class="knowledge-requirements">
                    <h4>ğŸ“ Was Sie wissen sollten:</h4>
                    <div class="knowledge-grid">
                        <div class="knowledge-item">
                            <strong>ğŸ” ECC Grundlagen</strong>
                            <ul>
                                <li>Elliptische Kurven-Arithmetik</li>
                                <li>Generator-Punkte</li>
                                <li>Discrete Logarithm Problem</li>
                            </ul>
                        </div>
                        <div class="knowledge-item">
                            <strong>ğŸ“œ PKI & Zertifikate</strong>
                            <ul>
                                <li>X.509 Zertifikat-Struktur</li>
                                <li>Certificate Authority (CA)</li>
                                <li>Digital Signatures</li>
                            </ul>
                        </div>
                        <div class="knowledge-item">
                            <strong>ğŸ› ï¸ Technische Skills</strong>
                            <ul>
                                <li>OpenSSL Commands</li>
                                <li>ASN.1 Format</li>
                                <li>Kryptographische Parameter</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="resources-section">
                    <h4>ğŸ“– Detaillierte EinfÃ¼hrung</h4>
                    <p>
                        FÃ¼r eine umfassende ErklÃ¤rung der mathematischen Grundlagen, technischen Details und 
                        Sicherheitsimplikationen lesen Sie unsere 
                        <a href="/introduction" target="_blank" class="resource-link">
                            vollstÃ¤ndige Curveball-EinfÃ¼hrung
                        </a>.
                    </p>
                    
                    <div class="quick-facts">
                        <div class="fact-item">
                            <span class="fact-label">Entdeckt:</span>
                            <span class="fact-value">Januar 2020 (NSA)</span>
                        </div>
                        <div class="fact-item">
                            <span class="fact-label">CVSS Score:</span>
                            <span class="fact-value">10.0 (Kritisch)</span>
                        </div>
                        <div class="fact-item">
                            <span class="fact-label">Betroffene Systeme:</span>
                            <span class="fact-value">~900 Millionen</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tutorial-section" id="tutorial-section">
            <h3>ğŸ“ Interaktives Tutorial - Erste Schritte</h3>
            
            <!-- Tutorial Step 1: Welcome -->
            <div class="tutorial-step active" id="tutorial-step-1">
                <div class="tutorial-header">
                    <h4>Willkommen zur Curveball Challenge!</h4>
                    <div class="tutorial-progress">
                        <div class="tutorial-progress-bar" style="width: 16.67%;"></div>
                    </div>
                    <span class="tutorial-step-indicator">Schritt 1 von 6</span>
                </div>
                <div class="tutorial-content">
                    <p>Dieses Tutorial fÃ¼hrt Sie Schritt fÃ¼r Schritt durch die <strong>CVE-2020-0601 Curveball Challenge</strong>. Sie lernen:</p>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li>âœ… Wie elliptische Kurven funktionieren</li>
                        <li>âœ… Was Generator-Punkte sind und warum sie wichtig sind</li>
                        <li>âœ… Wie die Curveball-Schwachstelle funktioniert</li>
                        <li>âœ… Wie Sie einen Exploit praktisch durchfÃ¼hren</li>
                    </ul>
                    <p><strong>GeschÃ¤tzte Dauer:</strong> 10-15 Minuten</p>
                </div>
                <div class="tutorial-controls">
                    <button class="tutorial-btn secondary" onclick="closeTutorial()">Tutorial Ã¼berspringen</button>
                    <button class="tutorial-btn" onclick="nextTutorialStep()">Los geht's! â†’</button>
                </div>
            </div>

            <!-- Tutorial Step 2: ECC Basics -->
            <div class="tutorial-step" id="tutorial-step-2">
                <div class="tutorial-header">
                    <h4>ğŸ“ Elliptische Kurven verstehen</h4>
                    <div class="tutorial-progress">
                        <div class="tutorial-progress-bar" style="width: 33.33%;"></div>
                    </div>
                    <span class="tutorial-step-indicator">Schritt 2 von 6</span>
                </div>
                <div class="tutorial-content">
                    <p>Elliptische Kurven bilden die Grundlage der <strong>ECC-Kryptographie</strong>. Sie basieren auf der mathematischen Gleichung:</p>
                    <div class="tutorial-example">
                        <h5>ğŸ“ Kurvengleichung:</h5>
                        <code>yÂ² = xÂ³ + ax + b</code>
                    </div>
                    <p>Jede Kurve hat spezielle Eigenschaften:</p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li><strong>Sicherheitslevel:</strong> Bestimmt durch die KurvengrÃ¶ÃŸe (z.B. 256 bit)</li>
                        <li><strong>Standards:</strong> NIST-Kurven wie P-256, P-384</li>
                        <li><strong>Generator-Punkt:</strong> Ein festgelegter Basispunkt auf der Kurve</li>
                    </ul>
                </div>
                <div class="tutorial-controls">
                    <button class="tutorial-btn secondary" onclick="prevTutorialStep()">â† ZurÃ¼ck</button>
                    <button class="tutorial-btn" onclick="nextTutorialStep()">Verstanden â†’</button>
                </div>
            </div>

            <!-- Tutorial Step 3: Generator Points -->
            <div class="tutorial-step" id="tutorial-step-3">
                <div class="tutorial-header">
                    <h4>ğŸ¯ Generator-Punkte - Das HerzstÃ¼ck</h4>
                    <div class="tutorial-progress">
                        <div class="tutorial-progress-bar" style="width: 50%;"></div>
                    </div>
                    <span class="tutorial-step-indicator">Schritt 3 von 6</span>
                </div>
                <div class="tutorial-content">
                    <p>Der <span class="tutorial-highlight">Generator-Punkt G</span> ist fundamental fÃ¼r ECC-Sicherheit:</p>
                    <div class="tutorial-example">
                        <h5>ğŸ”‘ SchlÃ¼sselerzeugung:</h5>
                        <code>Ã–ffentlicher_SchlÃ¼ssel = Privater_SchlÃ¼ssel Ã— Generator_Punkt</code><br>
                        <code>Q = d Ã— G</code>
                    </div>
                    <p><strong>Normale Sicherheit:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li>Generator G ist durch Standards festgelegt</li>
                        <li>Privater SchlÃ¼ssel d ist unbekannt und schwer zu finden</li>
                        <li>Ã–ffentlicher SchlÃ¼ssel Q ist berechenbar, aber d bleibt geheim</li>
                    </ul>
                    <p><strong>âš ï¸ Curveball Problem:</strong> Windows prÃ¼fte nicht, ob der Generator den Standards entspricht!</p>
                </div>
                <div class="tutorial-controls">
                    <button class="tutorial-btn secondary" onclick="prevTutorialStep()">â† ZurÃ¼ck</button>
                    <button class="tutorial-btn" onclick="nextTutorialStep()">Weiter zum Exploit â†’</button>
                </div>
            </div>

            <!-- Tutorial Step 4: The Vulnerability -->
            <div class="tutorial-step" id="tutorial-step-4">
                <div class="tutorial-header">
                    <h4>ğŸ’¥ Die Curveball-Schwachstelle</h4>
                    <div class="tutorial-progress">
                        <div class="tutorial-progress-bar" style="width: 66.67%;"></div>
                    </div>
                    <span class="tutorial-step-indicator">Schritt 4 von 6</span>
                </div>
                <div class="tutorial-content">
                    <p>Der <strong>CVE-2020-0601</strong> Exploit funktioniert so:</p>
                    <div class="tutorial-example">
                        <h5>ğŸš¨ Angreifer-Vorteil:</h5>
                        <code>Q = d' Ã— G'</code><br>
                        <small>â†³ Angreifer wÃ¤hlt sowohl d' als auch G' selbst!</small>
                    </div>
                    <p><strong>Normale Situation:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px; color: #4caf50;">
                        <li>âœ… Generator G ist standardisiert</li>
                        <li>âœ… Privater SchlÃ¼ssel d ist unbekannt</li>
                        <li>âœ… Sicherheit durch Discrete Logarithm Problem</li>
                    </ul>
                    <p><strong>Curveball Angriff:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px; color: #f44336;">
                        <li>âŒ Manipulierter Generator G' wird akzeptiert</li>
                        <li>âŒ Angreifer kennt passenden privaten SchlÃ¼ssel d'</li>
                        <li>âŒ "GÃ¼ltige" Zertifikate fÃ¼r beliebige IdentitÃ¤ten</li>
                    </ul>
                </div>
                <div class="tutorial-controls">
                    <button class="tutorial-btn secondary" onclick="prevTutorialStep()">â† ZurÃ¼ck</button>
                    <button class="tutorial-btn" onclick="nextTutorialStep()">Jetzt ausprobieren! â†’</button>
                </div>
            </div>

            <!-- Tutorial Step 5: Practical Example -->
            <div class="tutorial-step" id="tutorial-step-5">
                <div class="tutorial-header">
                    <h4>ğŸ§ª Praktisches Beispiel</h4>
                    <div class="tutorial-progress">
                        <div class="tutorial-progress-bar" style="width: 83.33%;"></div>
                    </div>
                    <span class="tutorial-step-indicator">Schritt 5 von 6</span>
                </div>
                <div class="tutorial-content">
                    <p>Versuchen wir einen einfachen Exploit! Folgen Sie diesen Schritten:</p>
                    <div class="tutorial-example">
                        <h5>ğŸ¯ Exploit-Anleitung:</h5>
                        <ol style="margin: 10px 0; padding-left: 20px;">
                            <li><strong>Kurve auswÃ¤hlen:</strong> WÃ¤hlen Sie "secp256r1" (sicher)</li>
                            <li><strong>Generator manipulieren:</strong> WÃ¤hlen Sie "rogue" aus der Preset-Liste</li>
                            <li><strong>Private Key setzen:</strong> Geben Sie "curveball123" ein</li>
                            <li><strong>Validierung starten:</strong> Klicken Sie "Parameter validieren"</li>
                        </ol>
                    </div>
                    <p><strong>Erwartetes Ergebnis:</strong> Der Exploit sollte erfolgreich sein und eine "gefÃ¤lschte" aber von Windows akzeptierte Signatur erzeugen!</p>
                </div>
                <div class="tutorial-controls">
                    <button class="tutorial-btn secondary" onclick="prevTutorialStep()">â† ZurÃ¼ck</button>
                    <button class="tutorial-btn try-it" onclick="startGuidedExample()">Guided Example starten â†’</button>
                </div>
            </div>

            <!-- Tutorial Step 6: Completion -->
            <div class="tutorial-step" id="tutorial-step-6">
                <div class="tutorial-header">
                    <h4>ğŸ‰ Tutorial abgeschlossen!</h4>
                    <div class="tutorial-progress">
                        <div class="tutorial-progress-bar" style="width: 100%;"></div>
                    </div>
                    <span class="tutorial-step-indicator">Schritt 6 von 6</span>
                </div>
                <div class="tutorial-content">
                    <p>Gratulation! Sie haben die Grundlagen der Curveball-Schwachstelle kennengelernt:</p>
                    <ul style="margin: 15px 0; padding-left: 20px; color: #4caf50;">
                        <li>âœ… ECC und Generator-Punkte verstanden</li>
                        <li>âœ… CVE-2020-0601 Schwachstelle erklÃ¤rt</li>
                        <li>âœ… Praktischen Exploit durchgefÃ¼hrt</li>
                    </ul>
                    <div class="tutorial-example">
                        <h5>ğŸš€ NÃ¤chste Schritte:</h5>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Experimentieren Sie mit verschiedenen Parametern</li>
                            <li>Nutzen Sie die Info-Icons (i) fÃ¼r detaillierte ErklÃ¤rungen</li>
                            <li>Sammeln Sie Hints bei Fehlversuchen</li>
                            <li>Versuchen Sie komplexere Exploit-Varianten</li>
                        </ul>
                    </div>
                    <p><strong>Viel SpaÃŸ beim Hacken! ğŸ”“</strong></p>
                </div>
                <div class="tutorial-controls">
                    <button class="tutorial-btn secondary" onclick="prevTutorialStep()">â† ZurÃ¼ck</button>
                    <button class="tutorial-btn" onclick="completeTutorial()">Challenge starten! ğŸš€</button>
                </div>
            </div>
        </div>

        <div class="challenge-info">
            <h3>ğŸ¯ Interactive ECC Parameter Challenge</h3>
            <p>
                Willkommen zur <strong>interaktiven Curveball-Challenge</strong>! Hier kÃ¶nnen Sie die 
                ECC-Parameter direkt manipulieren und die CVE-2020-0601 Schwachstelle spielerisch erforschen.
                Experimentieren Sie mit verschiedenen Parametern, bis Sie die Validierung umgehen kÃ¶nnen!
            </p>
            <div style="margin-top: 15px; padding: 15px; background: rgba(0, 100, 200, 0.1); border-radius: 8px;">
                <strong>ğŸ® Spielregeln:</strong><br>
                1. WÃ¤hlen Sie eine elliptische Kurve<br>
                2. Manipulieren Sie den Generator-Punkt<br>
                3. Setzen Sie einen Private Key<br>
                4. LÃ¶sen Sie die CVE-2020-0601 Schwachstelle aus!
            </div>
            <div style="margin-top: 15px; text-align: center;">
                <button class="tutorial-btn secondary" onclick="restartTutorial()">
                    ğŸ“ Tutorial neu starten
                </button>
            </div>
        </div>

        <div class="interactive-section">
            <h3>ï¿½ ECC Parameter Manipulation</h3>
            <form method="post" class="parameter-form" onsubmit="validateParameters(event)">
                
                <div class="parameter-group">
                    <label for="curve">
                        ğŸ“ Elliptische Kurve:
                        <span class="info-icon" onclick="toggleParameterInfo('curve-info-desc')">i</span>
                    </label>
                    <select id="curve" name="curve" class="param-select">
                        {% for curve_name, curve_info in curves.items() %}
                        <option value="{{ curve_name }}" 
                                data-size="{{ curve_info.size }}" 
                                data-secure="{{ curve_info.secure }}">
                            {{ curve_name }} ({{ curve_info.name }}, {{ curve_info.size }} bit)
                        </option>
                        {% endfor %}
                    </select>
                    <div class="param-info" id="curve-info">WÃ¤hlen Sie eine Kurve aus</div>
                    <div class="parameter-description" id="curve-info-desc">
                        <button class="close-btn" onclick="toggleParameterInfo('curve-info-desc')">Ã—</button>
                        <h5>ğŸ“ Elliptische Kurven - ErklÃ¤rung</h5>
                        <p><strong>Was sind elliptische Kurven?</strong><br>
                        Elliptische Kurven sind mathematische Strukturen, die in der Kryptographie fÃ¼r sichere VerschlÃ¼sselung verwendet werden. Sie basieren auf der Gleichung yÂ² = xÂ³ + ax + b.</p>
                        
                        <p><strong>Warum sind sie wichtig?</strong><br>
                        ECC (Elliptic Curve Cryptography) bietet die gleiche Sicherheit wie RSA mit deutlich kleineren SchlÃ¼sseln. Eine 256-bit ECC entspricht etwa einer 3072-bit RSA-VerschlÃ¼sselung.</p>
                        
                        <p><strong>Curveball-Relevanz:</strong><br>
                        Die Wahl der Kurve bestimmt die mathematischen Parameter. Windows validierte nicht ordnungsgemÃ¤ÃŸ, ob benutzerdefinierte Generator-Punkte zur gewÃ¤hlten Kurve gehÃ¶ren.</p>
                    </div>
                </div>

                <div class="parameter-group">
                    <label for="generator_preset">
                        ğŸ¯ Generator-Punkt (Vordefiniert):
                        <span class="info-icon" onclick="toggleParameterInfo('generator-preset-info-desc')">i</span>
                    </label>
                    <select id="generator_preset" name="generator_preset" class="param-select">
                        {% for gen_name, gen_info in generators.items() %}
                        <option value="{{ gen_name }}" data-x="{{ gen_info.x }}" data-valid="{{ gen_info.valid }}">
                            {{ gen_name.title() }} Generator
                            {% if not gen_info.valid %}âš ï¸ Manipuliert{% endif %}
                        </option>
                        {% endfor %}
                    </select>
                    <div class="parameter-description" id="generator-preset-info-desc">
                        <button class="close-btn" onclick="toggleParameterInfo('generator-preset-info-desc')">Ã—</button>
                        <h5>ğŸ¯ Generator-Punkt - ErklÃ¤rung</h5>
                        <p><strong>Was ist der Generator-Punkt?</strong><br>
                        Der Generator-Punkt G ist ein spezifischer Punkt auf der elliptischen Kurve, der zur Erzeugung aller anderen Punkte verwendet wird. Er ist ein fundamentaler Parameter in ECC.</p>
                        
                        <p><strong>Mathematische Bedeutung:</strong><br>
                        Alle Ã¶ffentlichen SchlÃ¼ssel werden durch Multiplikation des privaten SchlÃ¼ssels d mit dem Generator G berechnet: Q = d Ã— G</p>
                        
                        <p><strong>Curveball-Schwachstelle:</strong><br>
                        Windows prÃ¼fte nicht, ob der Generator-Punkt den offiziellen Standards entspricht. Angreifer konnten eigene Generator-Punkte verwenden und damit die Sicherheit vollstÃ¤ndig umgehen.</p>
                    </div>
                </div>

                <div class="parameter-group">
                    <label for="generator_x">
                        ğŸ”¢ Generator X-Koordinate:
                        <span class="info-icon" onclick="toggleParameterInfo('generator-x-info-desc')">i</span>
                    </label>
                    <input type="text" id="generator_x" name="generator_x" class="param-input" 
                           placeholder="Hex-Wert oder 'evil' fÃ¼r Exploit...">
                    <div class="param-info">Versuchen Sie 'rogue' oder eigene Werte mit 'evil'</div>
                    <div class="parameter-description" id="generator-x-info-desc">
                        <button class="close-btn" onclick="toggleParameterInfo('generator-x-info-desc')">Ã—</button>
                        <h5>ğŸ”¢ Generator X-Koordinate - ErklÃ¤rung</h5>
                        <p><strong>X-Koordinate des Generator-Punkts:</strong><br>
                        Dies ist die horizontale Koordinate des Generator-Punkts auf der elliptischen Kurve. In normalen Implementierungen ist dieser Wert durch Standards festgelegt.</p>
                        
                        <p><strong>Exploit-MÃ¶glichkeiten:</strong><br>
                        â€¢ <code>rogue</code> - Verwendet einen manipulierten Generator<br>
                        â€¢ <code>evil</code> - Aktiviert verschiedene Exploit-Varianten<br>
                        â€¢ Hex-Werte - Eigene X-Koordinaten testen</p>
                        
                        <p><strong>Sicherheitshinweis:</strong><br>
                        Ein manipulierter Generator ermÃ¶glicht es, "gÃ¼ltige" Signaturen fÃ¼r beliebige Daten zu erstellen, ohne den echten privaten SchlÃ¼ssel zu kennen.</p>
                    </div>
                </div>

                <div class="parameter-group">
                    <label for="generator_y">
                        ğŸ”¢ Generator Y-Koordinate:
                        <span class="info-icon" onclick="toggleParameterInfo('generator-y-info-desc')">i</span>
                    </label>
                    <input type="text" id="generator_y" name="generator_y" class="param-input" 
                           placeholder="Hex-Wert (optional)">
                    <div class="parameter-description" id="generator-y-info-desc">
                        <button class="close-btn" onclick="toggleParameterInfo('generator-y-info-desc')">Ã—</button>
                        <h5>ğŸ”¢ Generator Y-Koordinate - ErklÃ¤rung</h5>
                        <p><strong>Y-Koordinate des Generator-Punkts:</strong><br>
                        Dies ist die vertikale Koordinate des Generator-Punkts. Zusammen mit der X-Koordinate definiert sie den vollstÃ¤ndigen Punkt auf der Kurve.</p>
                        
                        <p><strong>Mathematische Beziehung:</strong><br>
                        Die Y-Koordinate muss der Kurvengleichung yÂ² = xÂ³ + ax + b entsprechen. FÃ¼r eine gegebene X-Koordinate gibt es maximal zwei gÃ¼ltige Y-Werte.</p>
                        
                        <p><strong>OptionalitÃ¤t:</strong><br>
                        Oft kann die Y-Koordinate aus der X-Koordinate berechnet werden. Die meisten Standards definieren, welcher der beiden mÃ¶glichen Y-Werte verwendet wird.</p>
                    </div>
                </div>

                <div class="parameter-group">
                    <label for="private_key">
                        ğŸ” Private Key:
                        <span class="info-icon" onclick="toggleParameterInfo('private-key-info-desc')">i</span>
                    </label>
                    <input type="text" id="private_key" name="private_key" class="param-input" 
                           placeholder="Ihr privater SchlÃ¼ssel...">
                    <div class="param-info">LÃ¤ngere Keys (>8 Zeichen) kÃ¶nnten hilfreicher sein</div>
                    <div class="parameter-description" id="private-key-info-desc">
                        <button class="close-btn" onclick="toggleParameterInfo('private-key-info-desc')">Ã—</button>
                        <h5>ğŸ” Private Key - ErklÃ¤rung</h5>
                        <p><strong>Was ist ein Private Key?</strong><br>
                        Der private SchlÃ¼ssel ist eine geheime Zahl, die nur dem Besitzer bekannt sein sollte. Er wird zur Erstellung digitaler Signaturen und zur EntschlÃ¼sselung verwendet.</p>
                        
                        <p><strong>Beziehung zum Public Key:</strong><br>
                        Der Ã¶ffentliche SchlÃ¼ssel Q wird durch Multiplikation berechnet: Q = private_key Ã— Generator_Point</p>
                        
                        <p><strong>Curveball-Kontext:</strong><br>
                        Bei manipulierten Generator-Punkten kÃ¶nnen Angreifer beliebige private SchlÃ¼ssel wÃ¤hlen und trotzdem "gÃ¼ltige" Zertifikate erstellen, die von Windows akzeptiert werden.</p>
                        
                        <p><strong>Tipp:</strong> LÃ¤ngere SchlÃ¼ssel (>8 Zeichen) erhÃ¶hen die Wahrscheinlichkeit, den Exploit auszulÃ¶sen.</p>
                    </div>
                </div>

                <div class="parameter-group">
                    <label for="signature_data">
                        âœï¸ Signature Data:
                        <span class="info-icon" onclick="toggleParameterInfo('signature-data-info-desc')">i</span>
                    </label>
                    <textarea id="signature_data" name="signature_data" class="param-textarea" 
                              placeholder="Optionale Signature-Daten..."></textarea>
                    <div class="parameter-description" id="signature-data-info-desc">
                        <button class="close-btn" onclick="toggleParameterInfo('signature-data-info-desc')">Ã—</button>
                        <h5>âœï¸ Signature Data - ErklÃ¤rung</h5>
                        <p><strong>Signatur-Daten:</strong><br>
                        Dies sind die Daten, die digital signiert werden sollen. In realen Anwendungen wÃ¤ren dies z.B. Dokumente, Software oder Zertifikatsinhalte.</p>
                        
                        <p><strong>Digitale Signaturen:</strong><br>
                        Eine digitale Signatur beweist, dass die Daten von dem Besitzer des privaten SchlÃ¼ssels stammen und nicht verÃ¤ndert wurden.</p>
                        
                        <p><strong>Curveball-Angriff:</strong><br>
                        Mit manipulierten Generator-Punkten kÃ¶nnen Angreifer gÃ¼ltige Signaturen fÃ¼r beliebige Daten erstellen, ohne den echten privaten SchlÃ¼ssel zu besitzen.</p>
                        
                        <p><strong>Verwendung:</strong> Dieser Parameter ist optional, aber kann bei der Demonstration verschiedener Angriffsvektoren hilfreich sein.</p>
                    </div>
                </div>

                <button type="submit" class="action-button validate-btn">
                    ğŸ§ª Parameter validieren
                </button>
            </form>
        </div>

        <div class="warning">
            <strong>âš ï¸ Warnung:</strong> Diese Simulation dient nur zu Bildungszwecken. 
            Die verwendeten Techniken sollten niemals in produktiven Umgebungen eingesetzt werden.
        </div>

        <div class="vulnerability-badge">CVE-2020-0601</div>
        <div class="vulnerability-badge">ECC Spoofing</div>
        <div class="vulnerability-badge">Certificate Validation</div>

        {% if validation_result %}
        <div class="validation-result {% if validation_result.success %}validation-success{% else %}validation-error{% endif %}">
            <strong>{% if validation_result.success %}ğŸ¯ EXPLOIT ERFOLGREICH!{% else %}âŒ Exploit fehlgeschlagen{% endif %}</strong><br>
            {{ validation_result.message }}
            
            {% if validation_result.debug %}
            <div class="debug-info">
                <h5>ğŸ” Debug-Informationen:</h5>
                <div class="debug-item {% if validation_result.debug.curve_secure %}success{% else %}warning{% endif %}">
                    Kurve sicher: {{ validation_result.debug.curve_secure }}
                </div>
                <div class="debug-item {% if validation_result.debug.generator_status == 'rogue' %}error{% else %}success{% endif %}">
                    Generator-Status: {{ validation_result.debug.generator_status }}
                </div>
                <div class="debug-item {% if validation_result.debug.vulnerability_triggered %}error{% else %}success{% endif %}">
                    Schwachstelle ausgelÃ¶st: {{ validation_result.debug.vulnerability_triggered }}
                </div>
                <div class="debug-item">
                    KurvengrÃ¶ÃŸe: {{ validation_result.debug.curve_size }} bit
                </div>
                <div class="debug-item">
                    Private Key LÃ¤nge: {{ validation_result.debug.private_key_length }}
                </div>
            </div>
            {% endif %}
        </div>
        {% endif %}

        <div class="hints-section">
            <button type="button" class="hint-button" onclick="loadHints()">
                ğŸ’¡ Hints anzeigen <span id="hint-counter">(verfÃ¼gbar nach Fehlversuchen)</span>
            </button>
            <div id="hints-container" class="hints-container hidden">
                <div id="progress-info" class="progress-info"></div>
                <div id="hints-list"></div>
            </div>
        </div>

        {% if flag %}
        <div class="flag-container">
            <h4>ğŸ† Erfolgreich authentifiziert!</h4>
            <div class="flag-value">{{ flag }}</div>
        </div>
        {% endif %}

        {% if certificate_info %}
        <div class="certificate-section">
            <h3>ğŸ“œ Generiertes Zertifikat - Details</h3>
            <div class="cert-content">
                <div class="cert-overview">
                    <div class="cert-status {{ 'cert-dangerous' if curveball_info.vulnerability_indicator else ('cert-custom' if curveball_info.custom_indicator else 'cert-safe') }}">
                        {% if curveball_info.vulnerability_indicator %}
                        âš ï¸ Unsichere Kurve erkannt! MÃ¶gliche Curveball-Schwachstelle.
                        {% else %}
                        âœ… Kurve als sicher validiert.
                        {% endif %}
                    </div>
                </div>

                <div class="cert-details">
                    <div class="cert-detail">
                        <strong>Aussteller:</strong> {{ certificate_info.issuer }}
                    </div>
                    <div class="cert-detail">
                        <strong>Betreff:</strong> {{ certificate_info.subject }}
                    </div>
                    <div class="cert-detail">
                        <strong>GÃ¼ltig von:</strong> {{ certificate_info.valid_from }}
                    </div>
                    <div class="cert-detail">
                        <strong>Bis:</strong> {{ certificate_info.valid_to }}
                    </div>
                    <div class="cert-detail">
                        <strong>Ã–ffentlicher SchlÃ¼ssel:</strong> {{ certificate_info.public_key }}
                    </div>
                </div>

                <div class="cert-actions">
                    <button class="action-button" onclick="downloadCertificate()">â¬‡ï¸ Zertifikat herunterladen</button>
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <script>
        // Set template variables for external JS
        window.currentFailedAttempts = {{ failed_attempts }};
    </script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>

</body>
</html>
